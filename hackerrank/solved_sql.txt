1.
select name from students where
marks > 75
order by substr(name, length(name)-2, 3), id asc;

2.
select name from employee
order by name asc;

3.
select concat( name, concat(concat('(', substr(occupation, 1, 1)), ')')) 
from occupations
order by name asc;
select concat('There are a total of ', count(occupation)), concat(lower(occupation),'s.') 
from occupations 
group by occupation
order by count(occupation), occupation asc;

4.
SELECT BT.N,
    CASE
        WHEN BT.P IS NULL THEN 'Root'
        WHEN EXISTS (SELECT B.P FROM BST B WHERE B.P = BT.N) THEN 'Inner'        
        ELSE 'Leaf'
    END
FROM BST AS BT 
ORDER BY BT.N

5.
SELECT cc.company_code,
    cc.founder,
    COUNT(distinct lm.lead_manager_code),
    COUNT(distinct sm.senior_manager_code),
    COUNT(distinct mg.manager_code),
    COUNT(distinct em.employee_code)
FROM
    company cc
LEFT JOIN
    lead_manager lm
    ON (lm.company_code = cc.company_code)
LEFT JOIN 
    senior_manager sm
    ON (sm.lead_manager_code = lm.lead_manager_code)
LEFT JOIN 
    manager mg
    ON (mg.senior_manager_code = sm.senior_manager_code)
LEFT JOIN 
    employee em
    ON (em.manager_code = mg.manager_code)
GROUP BY
    cc.company_code, cc.founder
ORDER BY
    cc.company_code;
	
6.
SELECT total, COUNT(*)
FROM (
  SELECT months * salary AS total
  FROM employee
) em
GROUP BY total
ORDER BY total DESC
LIMIT 1

7.
SELECT 
    ROUND(ln_sum, 2),
    ROUND(lo_sum, 2)
FROM (
    SELECT 
        SUM(LAT_N) as ln_sum,
        SUM(LONG_W) as lo_sum
        from station
) ST;


8.
SELECT 
    ROUND(ln_val, 4)
FROM (
    SELECT 
        SUM(LAT_N) as ln_val
        from station
        WHERE LAT_N > 38.7880 AND LAT_N < 137.2345
) ST;

9.
SELECT 
    ROUND(ln_val, 4)
FROM (
    SELECT 
        MAX(LAT_N) as ln_val
        from station
        WHERE LAT_N < 137.2345
) ST;

10.
SELECT ROUND(LONG_W,4)
FROM (
    SELECT
        LONG_W,
        LAT_N
    from station
    WHERE LAT_N < 137.2345
    ORDER BY LAT_N DESC
    LIMIT 1
) ST

11.
SELECT ROUND(LAT_N,4)
FROM (
    SELECT
        LAT_N
    from station
    WHERE LAT_N > 38.7780
    ORDER BY LAT_N ASC
    LIMIT 1
) ST

12.
SELECT ROUND(LONG_W,4)
FROM (
    SELECT
        LONG_W,
        LAT_N
    from station
    WHERE LAT_N > 38.7780
    ORDER BY LAT_N ASC
    LIMIT 1
) ST

13.
SELECT ROUND(MIN_DIFF_LAT_N + MIN_DIFF_LONG_W,4)
FROM (
	SELECT
        abs(min(LAT_N) - max(LAT_N)) as MIN_DIFF_LAT_N,
        abs(min(LONG_W) - max(LONG_W)) as MIN_DIFF_LONG_W
    from station
) ST

14.
SELECT ROUND(SQRT(MIN_DIFF_LAT_N*MIN_DIFF_LAT_N + MIN_DIFF_LONG_W*MIN_DIFF_LONG_W),4)
FROM (
	SELECT
        abs(min(LAT_N) - max(LAT_N)) as MIN_DIFF_LAT_N,
        abs(min(LONG_W) - max(LONG_W)) as MIN_DIFF_LONG_W
    from station
) ST

15.
SET @r=0, @total_rows=0;
SELECT ROUND(ST.LAT_N,4)
FROM (
    SELECT
        LAT_N, 
        @r:=@r+1 as row_number, 
        @total_rows := @r
    from station
    ORDER BY LAT_N ASC
) ST
WHERE ST.row_number = (@total_rows+1)/2;

16.
SELECT
    CASE
        WHEN ST.marks <= 70 THEN NULL
        ELSE ST.name
    END, 
    (
        SELECT 
            grade
        FROM grades GD
        WHERE ST.marks >= GD.min_mark AND ST.marks <= GD.max_mark
    ) AS C_GD,
    ST.marks
FROM students ST
ORDER BY C_GD DESC, ST.name ASC;
